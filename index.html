---
layout: default
title: Pull Spreadsheet
---


<h1>Google Spreadsheet To YAML in Jekyll</h1>
<p>This is a basic tool that pulls from a <a href="https://docs.google.com/spreadsheets/d/14OsbrDkjnr67J2TMzYO0EiFrixdYbf-UiMJ-HYNJhMI/pubhtml" target="_blank">Google Spreadsheet template</a>, and publish into a Github repository as a YAML to drive some of the Jekyll driven content here on this website.</p>
<p>For this to work you have to pass in ?token=[<a href="https://github.com/settings/tokens">personal access token</a>], from a Github account that has access to this repository. If you do not have valid token, the YAML will not save, but it will still pull from spreadsheet and display.</p>
<p>This is just a base component I will use in other micro tools to achieve this basic functionality for allowing YAML driven jekyll sites to be managed by a Google spreadsheet.</p>

<script type="text/javascript">

    // Reset the cookie manually
    //Cookies.expire('token');

    var $oAuthToken = getUrlVar('token');
    var $yaml_store = "";

    // When you fork, make sure ad add your org / user and repo name to _config.yml
    var $org = '{{ site.github_user }}';
    var $repo = '{{ site.github_repo }}';

    if($oAuthToken !='')
      {

      // Setting a cookie value
      Cookies.set('token', $oAuthToken);

      // Set with expiration
      // Cookies.set('token', $oAuthToken, { expires: '01/01/2017' });

      }

    // Grab the token from cookie
    $oAuthToken = Cookies.get('token');

    key = "14OsbrDkjnr67J2TMzYO0EiFrixdYbf-UiMJ-HYNJhMI";

    $(document).ready( function() {
      Tabletop.init( { key: key,
                       callback: showInfo,
                       wanted: [ "overview" ],
                       debug: true } )
    })

    function showInfo(data, tabletop) {

      $apidef = new Array();

      $.each( tabletop.sheets("overview").all(), function(i, service) {

          $swagger = service['swagger'];
          $info_title = service['info_title'];
          $info_description = service['info_description'];
          $info_termsOfService = service['info_termsOfService'];
          $host = service['host'];
          $basePath = service['basePath'];
          $schemes = service['schemes'];
          $produces = service['produces'];
          $version = service['version'];

          $apidef['swagger'] = $swagger;

          $i = {};
          $i['title'] = $id;
          $i['description'] = $title;
          $i['termsOfService'] = $description;
          $i['version'] = $price;

          $apidef['info'] = $i;

          $apidef['host'] = $host;
          $apidef['basePath'] = $basePath;

          $apidef['version'] = $version;

          $spec_json = JSON.stringify($apidef);
          $spec_json = JSON.stringify(JSON.parse($spec_json),null,2);

          $spec_yaml = jsyaml.dump($apidef);

          document.getElementById('source').value = $spec_yaml;

      })

    }

</script>
<textarea cols="10" rows="5" id="source" style="border: 1px solid #000; width: 100%; height: 350px;"></textarea>
<p>If you have any questions about this work, <a href="https://github.com/api-evangelist-tools/spreadsheet-to-yaml-in-jekyll/issues">submit an issue on the Github repository for the project</a>. or drop me a line at <a href="https://twitter.com/kinlane">@apievangelist</a>.</p>
